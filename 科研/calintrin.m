function s_obj=calintrin(intrinsics,freq)
Cgs=intrinsics(1);
Cgd=intrinsics(2);
Cds=intrinsics(3);
Ri=intrinsics(4);
Rj=intrinsics(5);
Rds=intrinsics(6);
gm=intrinsics(7);
tau=intrinsics(8);
omega=2*pi*freq;
m=length(freq);
YGS=(omega.^2*Cgs.^2*Ri+1j*omega*Cgs)./(1+omega.^2*Cgs.^2*Ri.^2);
YGD=(omega.^2*Cgd.^2*Rj+1j*omega*Cgd)./(1+omega.^2*Cgd.^2*Rj.^2);
YDS=1/Rds+1j*omega*Cds;
YGM=gm*exp(-1j*omega*tau)./(1+1j*omega*Cgs*Ri);
ypar=zeros(2,2,m);
ypar(1,1,:)=YGS+YGD;
ypar(1,2,:)=-YGD;
ypar(2,1,:)=YGM-YGD;
ypar(2,2,:)=YDS+YGD;
spar=y2s(ypar);
s_obj=sparameters(spar,freq);